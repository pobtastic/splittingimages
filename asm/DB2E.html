<!DOCTYPE html>
<html>
<head>
<title>Splitting Images: Routine at DB2E</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="DABF.html">DABF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#db2e">Map</a></td>
<td class="next">
Next: <a href="DB7E.html">DB7E</a>
</td>
</tr>
</table>
<div class="description">DB2E: Print Numbers</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="D352.html">D352</a>, <a href="EA00.html">Print_Bonus</a> and <a href="EA4A.html">Handler_MainMenu</a>.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">Number of digits to print</td>
</tr>
<tr>
<td class="register">BC</td>
<td class="register-desc">Screen co-ordinates where to print</td>
</tr>
<tr>
<td class="register">DE</td>
<td class="register-desc">Pointer to address of digits to print</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers</td>
<td class="address-2"><span id="db2e"></span>DB2E</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Stash <span class="register">AF</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db2f"></span>DB2F</td>
<td class="instruction">CALL <a href="DCC2.html">Calculate_ScreenBlockAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="DCC2.html">Calculate_ScreenBlockAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db32"></span>DB32</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db33"></span>DB33</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">RRCA.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db34"></span>DB34</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="db35"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routines at <a href="EA14.html">Print_Score</a> and <a href="EA2F.html">Print_Level</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers_0</td>
<td class="address-2"><span id="db35"></span>DB35</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db36"></span>DB36</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db37"></span>DB37</td>
<td class="instruction">AND %11110000</td>
<td class="comment-1" rowspan="1">Keep only bits 4-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db39"></span>DB39</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1">RRCA.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db3a"></span>DB3A</td>
<td class="instruction">CALL <a href="DB2E.html#db4c">Print_Numbers_1</a></td>
<td class="comment-1" rowspan="1">Call <a href="DB2E.html#db4c">Print_Numbers_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db3d"></span>DB3D</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db3e"></span>DB3E</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db3f"></span>DB3F</td>
<td class="instruction">AND %00001111</td>
<td class="comment-1" rowspan="1">Keep only bits 0-3.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db41"></span>DB41</td>
<td class="instruction">RLCA</td>
<td class="comment-1" rowspan="3">RLCA.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db42"></span>DB42</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db43"></span>DB43</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db44"></span>DB44</td>
<td class="instruction">CALL <a href="DB2E.html#db4c">Print_Numbers_1</a></td>
<td class="comment-1" rowspan="1">Call <a href="DB2E.html#db4c">Print_Numbers_1</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db47"></span>DB47</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1">Increment <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db48"></span>DB48</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db49"></span>DB49</td>
<td class="instruction">DJNZ <a href="DB2E.html#db35">Print_Numbers_0</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="DB2E.html#db35">Print_Numbers_0</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db4b"></span>DB4B</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers_1</td>
<td class="address-2"><span id="db4c"></span>DB4C</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="3">Stash <span class="register">BC</span>, <span class="register">DE</span> and <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db4d"></span>DB4D</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db4e"></span>DB4E</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db4f"></span>DB4F</td>
<td class="instruction">LD B,$00</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db51"></span>DB51</td>
<td class="instruction">LD C,A</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db52"></span>DB52</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db53"></span>DB53</td>
<td class="instruction">LD HL,$F2CE</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="F2CE.html">CustomFont</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db56"></span>DB56</td>
<td class="instruction">ADD HL,BC</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>+=<span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db57"></span>DB57</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db58"></span>DB58</td>
<td class="instruction">LD B,$08</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=08.</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers_2</td>
<td class="address-2"><span id="db5a"></span>DB5A</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db5b"></span>DB5B</td>
<td class="instruction">LD (DE),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db5c"></span>DB5C</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db5d"></span>DB5D</td>
<td class="instruction">LD IX,$D83A</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>=<a href="D83A.html">Time</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db61"></span>DB61</td>
<td class="instruction">BIT 1,(IX+$00)</td>
<td class="comment-1" rowspan="1">Test bit 1 of *<span class="register">IX</span>+00.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db65"></span>DB65</td>
<td class="instruction">JR Z,<a href="DB2E.html#db77">Print_Numbers_3</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="DB2E.html#db77">Print_Numbers_3</a> if <span class="register">HL</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db67"></span>DB67</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="3">Jump to <a href="DB2E.html#db77">Print_Numbers_3</a> if <span class="register">B</span> is not equal to 05.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db68"></span>DB68</td>
<td class="instruction">CP $05</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db6a"></span>DB6A</td>
<td class="instruction">JR NZ,<a href="DB2E.html#db77">Print_Numbers_3</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db6c"></span>DB6C</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db6d"></span>DB6D</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Exchange the <span class="register">DE</span> and <span class="register">HL</span> registers.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db6e"></span>DB6E</td>
<td class="instruction">LD DE,$06E0</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>-=06E0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db71"></span>DB71</td>
<td class="instruction">SBC HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db73"></span>DB73</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1">Exchange the <span class="register">DE</span> and <span class="register">HL</span> registers.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db74"></span>DB74</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db75"></span>DB75</td>
<td class="instruction">JR <a href="DB2E.html#db78">Print_Numbers_4</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="DB2E.html#db78">Print_Numbers_4</a>.</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers_3</td>
<td class="address-2"><span id="db77"></span>DB77</td>
<td class="instruction">INC D</td>
<td class="comment-1" rowspan="1">Increment <span class="register">D</span> by one.</td>
</tr>
<tr>
<td class="asm-label">Print_Numbers_4</td>
<td class="address-2"><span id="db78"></span>DB78</td>
<td class="instruction">DJNZ <a href="DB2E.html#db5a">Print_Numbers_2</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="DB2E.html#db5a">Print_Numbers_2</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db7a"></span>DB7A</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="3">Restore <span class="register">HL</span>, <span class="register">DE</span> and <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db7b"></span>DB7B</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db7c"></span>DB7C</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="db7d"></span>DB7D</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="DABF.html">DABF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#db2e">Map</a></td>
<td class="next">
Next: <a href="DB7E.html">DB7E</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1986 Domark Ltd &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.4.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/splittingimages/">Source code</a>.</div>
<div><a href="../dec/asm/56110.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>