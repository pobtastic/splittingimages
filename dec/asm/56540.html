<!DOCTYPE html>
<html>
<head>
<title>Splitting Images: Routine at 56540</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="56529.html">56529</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56540">Map</a></td>
<td class="next">
Next: <a href="56658.html">56658</a>
</td>
</tr>
</table>
<div class="description">56540: Move Tile Up</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="62526.html">62526</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">MoveTile_Up</td>
<td class="address-2"><span id="56540"></span>56540</td>
<td class="instruction">LD A,(59230)</td>
<td class="comment-1" rowspan="3">Take *<a href="59229.html#59230">Tile_Vertical_Position</a> and store it in <span class="register">A</span>. Decrease it by one, which adjusts the value for the tile height, and write this value to *<a href="59229.html#59232">Tile_Vertical_Coordinate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56543"></span>56543</td>
<td class="instruction">DEC A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56544"></span>56544</td>
<td class="instruction">LD (59232),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56547"></span>56547</td>
<td class="instruction">LD A,(59233)</td>
<td class="comment-1" rowspan="2"><span class="register">B</span>=*<a href="59229.html#59233">Tile_SpacesToMove</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56550"></span>56550</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="asm-label">MoveTile_Up_Loop</td>
<td class="address-2"><span id="56551"></span>56551</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the row counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56552"></span>56552</td>
<td class="instruction">LD A,(59229)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<a href="59229.html">Tile_Horizontal_Position</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56555"></span>56555</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56556"></span>56556</td>
<td class="instruction">LD (59231),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<a href="59229.html#59231">Tile_Horizontal_Coordinate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56559"></span>56559</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=4.</td>
</tr>
<tr>
<td class="asm-label">MoveTile_Up_0</td>
<td class="address-2"><span id="56561"></span>56561</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash the row (tile height) counter on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56562"></span>56562</td>
<td class="instruction">LD A,(59231)</td>
<td class="comment-1" rowspan="2"><span class="register">B</span>=*<a href="59229.html#59231">Tile_Horizontal_Coordinate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56565"></span>56565</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56566"></span>56566</td>
<td class="instruction">LD A,(59232)</td>
<td class="comment-1" rowspan="2"><span class="register">C</span>=*<a href="59229.html#59232">Tile_Vertical_Coordinate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56569"></span>56569</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56570"></span>56570</td>
<td class="instruction">CALL <a href="56514.html">Calculate_ScreenBlockAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56514.html">Calculate_ScreenBlockAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56573"></span>56573</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash the destination screen buffer address on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56574"></span>56574</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">B</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56575"></span>56575</td>
<td class="instruction">CALL <a href="56514.html">Calculate_ScreenBlockAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56514.html">Calculate_ScreenBlockAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56578"></span>56578</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="2"><span class="register">DE</span>=screen buffer address of the tile (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56579"></span>56579</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56580"></span>56580</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore the destination screen buffer address from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56581"></span>56581</td>
<td class="instruction">LD A,8</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=8.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56583"></span>56583</td>
<td class="instruction">LD BC,4</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0004.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56586"></span>56586</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="3">Stash <span class="register">HL</span>, <span class="register">HL</span> and <span class="register">DE</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label">MoveTile_Up_1</td>
<td class="address-2"><span id="56587"></span>56587</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56588"></span>56588</td>
<td class="instruction">PUSH DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56589"></span>56589</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">LDIR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56591"></span>56591</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56592"></span>56592</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56593"></span>56593</td>
<td class="instruction">LD (HL),C</td>
<td class="comment-1" rowspan="1">Write <span class="register">C</span> to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56594"></span>56594</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56595"></span>56595</td>
<td class="instruction">DEC DE</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56596"></span>56596</td>
<td class="instruction">LD BC,3</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0003.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56599"></span>56599</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56601"></span>56601</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="2">Restore <span class="register">DE</span> and <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56602"></span>56602</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56603"></span>56603</td>
<td class="instruction">INC D</td>
<td class="comment-1" rowspan="1">Increment <span class="register">D</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56604"></span>56604</td>
<td class="instruction">INC H</td>
<td class="comment-1" rowspan="1">Increment <span class="register">H</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56605"></span>56605</td>
<td class="instruction">LD BC,4</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0004.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56608"></span>56608</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56609"></span>56609</td>
<td class="instruction">JP NZ,<a href="56540.html#56587">MoveTile_Up_1</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="56540.html#56587">MoveTile_Up_1</a> if <span class="register">A</span> is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56612"></span>56612</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56613"></span>56613</td>
<td class="instruction">CALL <a href="56529.html">Calculate_AttributeAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56529.html">Calculate_AttributeAddress</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56616"></span>
<div class="comments">
<div class="paragraph">
Move <span class="register">DE</span> up one attribute row.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56616"></span>56616</td>
<td class="instruction">LD HL,65504</td>
<td class="comment-1" rowspan="3"><span class="register">DE</span>+=65504 (subtract 0032).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56619"></span>56619</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56620"></span>56620</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56621"></span>56621</td>
<td class="instruction">LD BC,4</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0004.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56624"></span>56624</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">LDIR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56626"></span>56626</td>
<td class="instruction">LD BC,3</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0003.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56629"></span>56629</td>
<td class="instruction">LD A,71</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=INK:
WHITE,
PAPER:
BLACK
(BRIGHT)
.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56631"></span>56631</td>
<td class="instruction">DEC HL</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56632"></span>56632</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1">Write <span class="register">A</span> to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56633"></span>56633</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56634"></span>56634</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1">Restore <span class="register">DE</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56635"></span>56635</td>
<td class="instruction">DEC DE</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56636"></span>56636</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56638"></span>56638</td>
<td class="instruction">LD HL,59231</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59229.html#59231">Tile_Horizontal_Coordinate</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56641"></span>56641</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Increment *<span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56642"></span>56642</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56643"></span>56643</td>
<td class="instruction">DJNZ <a href="56540.html#56561">MoveTile_Up_0</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="56540.html#56561">MoveTile_Up_0</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56645"></span>56645</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56646"></span>56646</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56647"></span>56647</td>
<td class="instruction">CALL <a href="56658.html">Sound_TileMovement</a></td>
<td class="comment-1" rowspan="1">Call <a href="56658.html">Sound_TileMovement</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56650"></span>56650</td>
<td class="instruction">LD HL,59229</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59229.html">Tile_Horizontal_Position</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56653"></span>56653</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-1" rowspan="1">Decrease *<span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56654"></span>56654</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the number of spaces left to move from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56655"></span>56655</td>
<td class="instruction">DJNZ <a href="56540.html#56551">MoveTile_Up_Loop</a></td>
<td class="comment-1" rowspan="1">Decrease the number of spaces counter by one and loop back to <a href="56540.html#56551">MoveTile_Up_Loop</a> until the tile is in the destination space.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56657"></span>56657</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="56529.html">56529</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56540">Map</a></td>
<td class="next">
Next: <a href="56658.html">56658</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1986 Domark Ltd &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.4.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/splittingimages/">Source code</a>.</div>
<div><a href="../../asm/DCDC.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>