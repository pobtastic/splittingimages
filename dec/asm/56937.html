<!DOCTYPE html>
<html>
<head>
<title>Splitting Images: Routine at 56937</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="56913.html">56913</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56937">Map</a></td>
<td class="next">
Next: <a href="57176.html">57176</a>
</td>
</tr>
</table>
<div class="description">56937: Draw Tile</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="63489.html">63489</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile</td>
<td class="address-2"><span id="56937"></span>56937</td>
<td class="instruction">LD IX,57176</td>
<td class="comment-1" rowspan="1">Set <span class="register">IX</span> to <a href="57176.html">Table_TileDataOffsets</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56941"></span>56941</td>
<td class="instruction">LD B,0</td>
<td class="comment-1" rowspan="1">Initialise <span class="register">B</span> to 0 for the sum below.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56943"></span>56943</td>
<td class="instruction">LD A,(58055)</td>
<td class="comment-1" rowspan="1">Load *<a href="58055.html">Item_ID</a> into <span class="register">A</span>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56946"></span>
<div class="comments">
<div class="paragraph">
Find which spritesheet the image is located in. There are 20 sprites in each sheet, so test if the sprite ID is less than 21 to check if it's in the first one. Else, subtract 20 and check again.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56946"></span>56946</td>
<td class="instruction">LD C,3</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">C</span> with 3 to track the three spritesheets (two item sheets and one for the game tiles).</td>
</tr>
<tr>
<td class="asm-label">FindSpritesheet_Loop</td>
<td class="address-2"><span id="56948"></span>56948</td>
<td class="instruction">CP 21</td>
<td class="comment-1" rowspan="2">Jump to <a href="56937.html#56960">LocateSprite</a> if <span class="register">A</span> is lower than 21 (unsigned comparison).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56950"></span>56950</td>
<td class="instruction">JP M,<a href="56937.html#56960">LocateSprite</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56953"></span>56953</td>
<td class="instruction">SUB 20</td>
<td class="comment-1" rowspan="1">Subtract 20 from <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56955"></span>56955</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">C</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56956"></span>56956</td>
<td class="instruction">JR NZ,<a href="56937.html#56948">FindSpritesheet_Loop</a></td>
<td class="comment-1" rowspan="1">Jump back to <a href="56937.html#56948">FindSpritesheet_Loop</a> until <span class="register">C</span> is zero.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56958"></span>
<div class="comments">
<div class="paragraph">
Default the sprite ID to 1.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56958"></span>56958</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=1.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56960"></span>
<div class="comments">
<div class="paragraph">
Adjust the sprite ID for 0-based indexing.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">LocateSprite</td>
<td class="address-2"><span id="56960"></span>56960</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Decrease the sprite ID by one.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56961"></span>
<div class="comments">
<div class="paragraph">
There are 4 offset bytes, so multiply the sprite ID by 4 to find the relevant offsets in the table.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56961"></span>56961</td>
<td class="instruction">RLCA</td>
<td class="comment-1" rowspan="3">Multiply the sprite ID by 4 and store the result in <span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56962"></span>56962</td>
<td class="instruction">RLCA</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56963"></span>56963</td>
<td class="instruction">LD C,A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56964"></span>
<div class="comments">
<div class="paragraph">
Fetch the offsets for the sprite being processed.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56964"></span>56964</td>
<td class="instruction">ADD IX,BC</td>
<td class="comment-1" rowspan="1">Add the result to <span class="register">IX</span> to locate the offsets for the tile.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56966"></span>56966</td>
<td class="instruction">LD C,(IX+0)</td>
<td class="comment-1" rowspan="2">Fetch the graphic data offset and store it in <span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56969"></span>56969</td>
<td class="instruction">LD B,(IX+1)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56972"></span>56972</td>
<td class="instruction">LD E,(IX+2)</td>
<td class="comment-1" rowspan="2">Fetch the attribute data offset and store it in <span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56975"></span>56975</td>
<td class="instruction">LD D,(IX+3)</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56978"></span>
<div class="comments">
<div class="paragraph">
Calculate the graphic data address.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56978"></span>56978</td>
<td class="instruction">LD IX,(58056)</td>
<td class="comment-1" rowspan="2">Add *<a href="58056.html">Item_SpriteBank</a> and the offset in <span class="register">BC</span> to locate the start of the graphics data - store the result in <span class="register">IX</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56982"></span>56982</td>
<td class="instruction">ADD IX,BC</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56984"></span>
<div class="comments">
<div class="paragraph">
Calculate the attribute address.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56984"></span>56984</td>
<td class="instruction">LD HL,(58056)</td>
<td class="comment-1" rowspan="6">Add *<a href="58056.html">Item_SpriteBank</a> and 2560 to locate the start of the attributes for the spritesheet. Then, add the offset held in <span class="register">DE</span> to the total, this will locate the start of the attributes for the sprite currently being processed - store the result in <span class="register">IY</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56987"></span>56987</td>
<td class="instruction">LD BC,2560</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56990"></span>56990</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56991"></span>56991</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56992"></span>56992</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56993"></span>56993</td>
<td class="instruction">POP IY</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="56995"></span>
<div class="comments">
<div class="paragraph">
Print the sprite to the screen.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56995"></span>56995</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="56997"></span>56997</td>
<td class="instruction">LD H,40</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=40.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_0</td>
<td class="address-2"><span id="56999"></span>56999</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57000"></span>57000</td>
<td class="instruction">LD A,8</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=8.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57002"></span>57002</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1">Stash <span class="register">IX</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57004"></span>57004</td>
<td class="instruction">LD BC,20</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0020.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_1</td>
<td class="address-2"><span id="57007"></span>57007</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">Stash <span class="register">AF</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57008"></span>57008</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=<span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57009"></span>57009</td>
<td class="instruction">CALL <a href="56913.html">CalculateScreenAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56913.html">CalculateScreenAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57012"></span>57012</td>
<td class="instruction">LD A,(IX+0)</td>
<td class="comment-1" rowspan="2">Write *<span class="register">IX</span>+0 to *<span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57015"></span>57015</td>
<td class="instruction">LD (DE),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57016"></span>57016</td>
<td class="instruction">ADD IX,BC</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span>+=<span class="register">BC</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57018"></span>57018</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="1">Restore <span class="register">AF</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57019"></span>57019</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1">Increment <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57020"></span>57020</td>
<td class="instruction">CP 40</td>
<td class="comment-1" rowspan="2">Jump to <a href="56937.html#57007">Draw_Tile_1</a> if <span class="register">A</span> is not equal to 40.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57022"></span>57022</td>
<td class="instruction">JP NZ,<a href="56937.html#57007">Draw_Tile_1</a></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="57025"></span>
<div class="comments">
<div class="paragraph">
Switch <span class="register">IX</span> to point to the attributes.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57025"></span>57025</td>
<td class="instruction">PUSH IY</td>
<td class="comment-1" rowspan="2"><span class="register">IX</span>=<span class="register">IY</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57027"></span>57027</td>
<td class="instruction">POP IX</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57029"></span>57029</td>
<td class="instruction">LD DE,22565</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=22565 (attribute buffer location).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57032"></span>57032</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57034"></span>57034</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label">Colour_Tile_Loop</td>
<td class="address-2"><span id="57035"></span>57035</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57036"></span>57036</td>
<td class="instruction">LD A,(IX+0)</td>
<td class="comment-1" rowspan="2">Write *<span class="register">IX</span>+0 to *<span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57039"></span>57039</td>
<td class="instruction">LD (DE),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57040"></span>57040</td>
<td class="instruction">LD BC,20</td>
<td class="comment-1" rowspan="2"><span class="register">IX</span>+=0020.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57043"></span>57043</td>
<td class="instruction">ADD IX,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57045"></span>57045</td>
<td class="instruction">LD HL,32</td>
<td class="comment-1" rowspan="3"><span class="register">DE</span>+=0032.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57048"></span>57048</td>
<td class="instruction">ADD HL,DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57049"></span>57049</td>
<td class="instruction">EX DE,HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57050"></span>57050</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57051"></span>57051</td>
<td class="instruction">DJNZ <a href="56937.html#57035">Colour_Tile_Loop</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="56937.html#57035">Colour_Tile_Loop</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57053"></span>57053</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="3">Restore <span class="register">HL</span>, <span class="register">IX</span> and <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57054"></span>57054</td>
<td class="instruction">POP IX</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57056"></span>57056</td>
<td class="instruction">POP BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57057"></span>57057</td>
<td class="instruction">LD A,B</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=<span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57058"></span>57058</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="3">Stash <span class="register">BC</span>, <span class="register">IX</span> and <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57059"></span>57059</td>
<td class="instruction">PUSH IX</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57061"></span>57061</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57062"></span>57062</td>
<td class="instruction">CP 1</td>
<td class="comment-1" rowspan="2">Jump to <a href="56937.html#57163">Draw_Tile_7</a> if <span class="register">A</span> is equal to 1.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57064"></span>57064</td>
<td class="instruction">JP Z,<a href="56937.html#57163">Draw_Tile_7</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57067"></span>57067</td>
<td class="instruction">LD A,5</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=5.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57069"></span>57069</td>
<td class="instruction">LD C,35</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=35.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_2</td>
<td class="address-2"><span id="57071"></span>57071</td>
<td class="instruction">LD B,C</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=<span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57072"></span>57072</td>
<td class="instruction">SLA B</td>
<td class="comment-1" rowspan="1">Shift <span class="register">B</span> left (with carry).</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_3</td>
<td class="address-2"><span id="57074"></span>57074</td>
<td class="instruction">DJNZ <a href="56937.html#57074">Draw_Tile_3</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="56937.html#57074">Draw_Tile_3</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57076"></span>57076</td>
<td class="instruction">XOR %00010000</td>
<td class="comment-1" rowspan="1">Flip bit 4.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57078"></span>57078</td>
<td class="instruction">OUT (254),A</td>
<td class="comment-1" rowspan="1">Send to the speaker.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57080"></span>57080</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">C</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57081"></span>57081</td>
<td class="instruction">JP NZ,<a href="56937.html#57071">Draw_Tile_2</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="56937.html#57071">Draw_Tile_2</a> until <span class="register">C</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57084"></span>57084</td>
<td class="instruction">LD HL,5000</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=5000.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57087"></span>57087</td>
<td class="instruction">LD DE,1250</td>
<td class="comment-1" rowspan="1"><span class="register">DE</span>=1250.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_4</td>
<td class="address-2"><span id="57090"></span>57090</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=*<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57091"></span>57091</td>
<td class="instruction">AND %11110000</td>
<td class="comment-1" rowspan="1">Keep only bits 4-7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57093"></span>57093</td>
<td class="instruction">OR %00000101</td>
<td class="comment-1" rowspan="1">Set bits 0, 2.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57095"></span>57095</td>
<td class="instruction">OUT (254),A</td>
<td class="comment-1" rowspan="1">Send to the speaker.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57097"></span>57097</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57098"></span>57098</td>
<td class="instruction">DEC DE</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57099"></span>57099</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="3">Jump to <a href="56937.html#57090">Draw_Tile_4</a> if <span class="register">DE</span> is not zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57100"></span>57100</td>
<td class="instruction">OR E</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57101"></span>57101</td>
<td class="instruction">JP NZ,<a href="56937.html#57090">Draw_Tile_4</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57104"></span>57104</td>
<td class="instruction">LD A,1</td>
<td class="comment-1" rowspan="2">Write 1 to *<a href="59229.html#59231">59231</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57106"></span>57106</td>
<td class="instruction">LD (59231),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57109"></span>57109</td>
<td class="instruction">LD B,4</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=4.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_5</td>
<td class="address-2"><span id="57111"></span>57111</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">Stash <span class="register">BC</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57112"></span>57112</td>
<td class="instruction">LD A,(59231)</td>
<td class="comment-1" rowspan="2"><span class="register">B</span>=*<a href="59229.html#59231">59231</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57115"></span>57115</td>
<td class="instruction">LD B,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57116"></span>57116</td>
<td class="instruction">LD C,7</td>
<td class="comment-1" rowspan="1"><span class="register">C</span>=7.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57118"></span>57118</td>
<td class="instruction">CALL <a href="56514.html">Calculate_ScreenBlockAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56514.html">Calculate_ScreenBlockAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57121"></span>57121</td>
<td class="instruction">LD A,8</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=8.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57123"></span>57123</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_6</td>
<td class="address-2"><span id="57124"></span>57124</td>
<td class="instruction">LD BC,3</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0003.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57127"></span>57127</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="2"><span class="register">DE</span>=<span class="register">HL</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57128"></span>57128</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57129"></span>57129</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1">Increment <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57130"></span>57130</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">Stash <span class="register">HL</span> on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57131"></span>57131</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57133"></span>57133</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment <span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57134"></span>57134</td>
<td class="instruction">LD (HL),C</td>
<td class="comment-1" rowspan="1">Write <span class="register">C</span> to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57135"></span>57135</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57136"></span>57136</td>
<td class="instruction">INC H</td>
<td class="comment-1" rowspan="1">Increment <span class="register">H</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57137"></span>57137</td>
<td class="instruction">DEC A</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">A</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57138"></span>57138</td>
<td class="instruction">JP NZ,<a href="56937.html#57124">Draw_Tile_6</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="56937.html#57124">Draw_Tile_6</a> until <span class="register">A</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57141"></span>57141</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore <span class="register">HL</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57142"></span>57142</td>
<td class="instruction">CALL <a href="56529.html">Calculate_AttributeAddress</a></td>
<td class="comment-1" rowspan="1">Call <a href="56529.html">Calculate_AttributeAddress</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57145"></span>57145</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="2"><span class="register">HL</span>=<span class="register">DE</span> (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57146"></span>57146</td>
<td class="instruction">POP HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57147"></span>57147</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1">Increment <span class="register">DE</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57148"></span>57148</td>
<td class="instruction">LD BC,3</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0003.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57151"></span>57151</td>
<td class="instruction">LDDR</td>
<td class="comment-1" rowspan="1">LDDR.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57153"></span>57153</td>
<td class="instruction">LD A,0</td>
<td class="comment-1" rowspan="2">Write 0 to *<span class="register">DE</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57155"></span>57155</td>
<td class="instruction">LD (DE),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57156"></span>57156</td>
<td class="instruction">LD HL,59231</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="59229.html#59231">59231</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57159"></span>57159</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1">Increment *<span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57160"></span>57160</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57161"></span>57161</td>
<td class="instruction">DJNZ <a href="56937.html#57111">Draw_Tile_5</a></td>
<td class="comment-1" rowspan="1">Decrease counter by one and loop back to <a href="56937.html#57111">Draw_Tile_5</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label">Draw_Tile_7</td>
<td class="address-2"><span id="57163"></span>57163</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="2">Restore <span class="register">HL</span> and <span class="register">IX</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57164"></span>57164</td>
<td class="instruction">POP IX</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57166"></span>57166</td>
<td class="instruction">DEC IX</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">IX</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57168"></span>57168</td>
<td class="instruction">DEC IY</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">IY</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57170"></span>57170</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore <span class="register">BC</span> from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57171"></span>57171</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1">Decrease <span class="register">B</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57172"></span>57172</td>
<td class="instruction">JP NZ,<a href="56937.html#56999">Draw_Tile_0</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="56937.html#56999">Draw_Tile_0</a> until <span class="register">B</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57175"></span>57175</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="56913.html">56913</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56937">Map</a></td>
<td class="next">
Next: <a href="57176.html">57176</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1986 Domark Ltd &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.4.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/splittingimages/">Source code</a>.</div>
<div><a href="../../asm/DE69.html">Switch to hexadecimal</a>.</div>
</footer>
</body>
</html>