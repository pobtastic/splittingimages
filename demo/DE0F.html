<!DOCTYPE html>
<html>
<head>
<title>Splitting Images: Routine at DE0F</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-wide.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-75RERFCHBG"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-75RERFCHBG');
</script>
</head>
<body class="demo-Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="DDFA.html">DDFA</a>
</td>
<td class="up">Up: <a href="../demo.html#de0f">Map</a></td>
<td class="next">
Next: <a href="DEED.html">DEED</a>
</td>
</tr>
</table>
<div class="description">DE0F: Generate Picture</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="D234.html">Game_Initialisation</a>.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">IX</td>
<td class="register-desc">Pointer to level graphics data</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="de0f"></span>
<div class="comments">
<div class="paragraph">
<span class="register">IX</span> will point to one of: <table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Level</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="9470.html">GraphicsData_Level_01</a></td>
<td class="centre" colspan="1" rowspan="1">Level 01</td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture</td>
<td class="address-2"><span id="de0f"></span>DE0F</td>
<td class="instruction">LD HL,$A0E3</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="A0E3.html">Buffer_Image</a>.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="de12"></span>
<div class="comments">
<div class="paragraph">
Clear down the buffer ready for the new image to be generated.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de12"></span>DE12</td>
<td class="instruction">LD BC,$0B40</td>
<td class="comment-1" rowspan="1"><span class="register">BC</span>=0B40.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de15"></span>DE15</td>
<td class="instruction">LD (HL),$00</td>
<td class="comment-1" rowspan="1">Write 00 to *<span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de17"></span>DE17</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="3"><span class="register">DE</span>=<a href="A0E3.html">Buffer_Image</a>+01 (using the stack).</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de18"></span>DE18</td>
<td class="instruction">POP DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de19"></span>DE19</td>
<td class="instruction">INC DE</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de1a"></span>DE1A</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1">Clear 0B40 bytes of data in <a href="A0E3.html">Buffer_Image</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de1c"></span>DE1C</td>
<td class="instruction">LD A,$80</td>
<td class="comment-1" rowspan="2">Write 80 to *<a href="DE0F.html#dee9">Line_Counter</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de1e"></span>DE1E</td>
<td class="instruction">LD ($DEE9),A</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_0</td>
<td class="address-2"><span id="de21"></span>DE21</td>
<td class="instruction">LD A,$80</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de23"></span>DE23</td>
<td class="instruction">LD HL,$DEE9</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de26"></span>DE26</td>
<td class="instruction">SUB (HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de27"></span>DE27</td>
<td class="instruction">LD B,$14</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de29"></span>DE29</td>
<td class="instruction">LD D,$00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de2b"></span>DE2B</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de2c"></span>DE2C</td>
<td class="instruction">LD HL,$A0E3</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_1</td>
<td class="address-2"><span id="de2f"></span>DE2F</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de30"></span>DE30</td>
<td class="instruction">DJNZ <a href="DE0F.html#de2f">GeneratePicture_1</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de32"></span>DE32</td>
<td class="instruction">LD ($DEEB),HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de35"></span>DE35</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de38"></span>DE38</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de3a"></span>DE3A</td>
<td class="instruction">CP $C9</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de3c"></span>DE3C</td>
<td class="instruction">JR Z,<a href="DE0F.html#de72">GeneratePicture_7</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de3e"></span>DE3E</td>
<td class="instruction">CP $CA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de40"></span>DE40</td>
<td class="instruction">JR Z,<a href="DE0F.html#de50">GeneratePicture_2</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de42"></span>DE42</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de44"></span>DE44</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de45"></span>DE45</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de46"></span>DE46</td>
<td class="instruction">LD BC,$0014</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de49"></span>DE49</td>
<td class="instruction">LDIR</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de4b"></span>DE4B</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de4c"></span>DE4C</td>
<td class="instruction">POP IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de4e"></span>DE4E</td>
<td class="instruction">JR <a href="DE0F.html#debb">GeneratePicture_Next</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_2</td>
<td class="address-2"><span id="de50"></span>DE50</td>
<td class="instruction">PUSH IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de52"></span>DE52</td>
<td class="instruction">POP DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_3</td>
<td class="address-2"><span id="de53"></span>DE53</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de54"></span>DE54</td>
<td class="instruction">CP $00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de56"></span>DE56</td>
<td class="instruction">JR Z,<a href="DE0F.html#de5d">GeneratePicture_4</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de58"></span>DE58</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de59"></span>DE59</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de5a"></span>DE5A</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de5b"></span>DE5B</td>
<td class="instruction">JR <a href="DE0F.html#de53">GeneratePicture_3</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_4</td>
<td class="address-2"><span id="de5d"></span>DE5D</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de5e"></span>DE5E</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de5f"></span>DE5F</td>
<td class="instruction">CP $00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de61"></span>DE61</td>
<td class="instruction">JR Z,<a href="DE0F.html#de6c">GeneratePicture_6</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de63"></span>DE63</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de64"></span>DE64</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_5</td>
<td class="address-2"><span id="de65"></span>DE65</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de66"></span>DE66</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de67"></span>DE67</td>
<td class="instruction">DJNZ <a href="DE0F.html#de65">GeneratePicture_5</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de69"></span>DE69</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de6a"></span>DE6A</td>
<td class="instruction">JR <a href="DE0F.html#de53">GeneratePicture_3</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_6</td>
<td class="address-2"><span id="de6c"></span>DE6C</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de6d"></span>DE6D</td>
<td class="instruction">PUSH DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de6e"></span>DE6E</td>
<td class="instruction">POP IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de70"></span>DE70</td>
<td class="instruction">JR <a href="DE0F.html#debb">GeneratePicture_Next</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_7</td>
<td class="address-2"><span id="de72"></span>DE72</td>
<td class="instruction">LD B,(IX+$01)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de75"></span>DE75</td>
<td class="instruction">LD A,(IX+$00)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de78"></span>DE78</td>
<td class="instruction">LD ($DEEA),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_8</td>
<td class="address-2"><span id="de7b"></span>DE7B</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de7c"></span>DE7C</td>
<td class="instruction">LD A,($DEEA)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de7f"></span>DE7F</td>
<td class="instruction">CP $C9</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de81"></span>DE81</td>
<td class="instruction">JR Z,<a href="DE0F.html#de8b">GeneratePicture_9</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de83"></span>DE83</td>
<td class="instruction">CP $CA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de85"></span>DE85</td>
<td class="instruction">JR Z,<a href="DE0F.html#de8b">GeneratePicture_9</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de87"></span>DE87</td>
<td class="instruction">CP $CB</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de89"></span>DE89</td>
<td class="instruction">JR NZ,<a href="DE0F.html#de8e">GeneratePicture_10</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_9</td>
<td class="address-2"><span id="de8b"></span>DE8B</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de8c"></span>DE8C</td>
<td class="instruction">JR <a href="DE0F.html#debb">GeneratePicture_Next</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_10</td>
<td class="address-2"><span id="de8e"></span>DE8E</td>
<td class="instruction">AND $F8</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de90"></span>DE90</td>
<td class="instruction">LD D,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de91"></span>DE91</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de92"></span>DE92</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de93"></span>DE93</td>
<td class="instruction">RRCA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de94"></span>DE94</td>
<td class="instruction">LD E,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de95"></span>DE95</td>
<td class="instruction">LD A,($DEEA)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de98"></span>DE98</td>
<td class="instruction">SUB D</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de99"></span>DE99</td>
<td class="instruction">LD D,$00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de9b"></span>DE9B</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de9c"></span>DE9C</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de9d"></span>DE9D</td>
<td class="instruction">INC B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de9e"></span>DE9E</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="de9f"></span>DE9F</td>
<td class="instruction">AND A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea0"></span>DEA0</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_11</td>
<td class="address-2"><span id="dea1"></span>DEA1</td>
<td class="instruction">RLA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea2"></span>DEA2</td>
<td class="instruction">DJNZ <a href="DE0F.html#dea1">GeneratePicture_11</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea4"></span>DEA4</td>
<td class="instruction">SCF</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea5"></span>DEA5</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_12</td>
<td class="address-2"><span id="dea6"></span>DEA6</td>
<td class="instruction">RRA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea7"></span>DEA7</td>
<td class="instruction">DJNZ <a href="DE0F.html#dea6">GeneratePicture_12</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dea9"></span>DEA9</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deaa"></span>DEAA</td>
<td class="instruction">LD HL,$DEEA</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dead"></span>DEAD</td>
<td class="instruction">INC (HL)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deae"></span>DEAE</td>
<td class="instruction">LD HL,($DEEB)</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deb1"></span>DEB1</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deb2"></span>DEB2</td>
<td class="instruction">DJNZ <a href="DE0F.html#de7b">GeneratePicture_8</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deb4"></span>DEB4</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deb6"></span>DEB6</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deb8"></span>DEB8</td>
<td class="instruction">JP <a href="DE0F.html#de72">GeneratePicture_7</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="debb"></span>
<div class="comments">
<div class="paragraph">
Has all the image been decompressed now? If not, loop back again.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_Next</td>
<td class="address-2"><span id="debb"></span>DEBB</td>
<td class="instruction">LD HL,$DEE9</td>
<td class="comment-1" rowspan="1"><span class="register">HL</span>=<a href="DE0F.html#dee9">Line_Counter</a>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="debe"></span>DEBE</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-1" rowspan="1">Decrease *<span class="register">HL</span> by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="debf"></span>DEBF</td>
<td class="instruction">JP NZ,<a href="DE0F.html#de21">GeneratePicture_0</a></td>
<td class="comment-1" rowspan="1">Jump to <a href="DE0F.html#de21">GeneratePicture_0</a> until *<span class="register">HL</span> is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dec2"></span>DEC2</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1">Move <span class="register">IX</span> to the start of the attribute data.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dec4"></span>DEC4</td>
<td class="instruction">LD B,$10</td>
<td class="comment-1" rowspan="1">Set a counter in <span class="register">B</span> to process 10 rows of attribute data.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dec6"></span>DEC6</td>
<td class="instruction">LD HL,$AAE3</td>
<td class="comment-1" rowspan="1">Store the start of <a href="A0E3.html#aae3">Buffer_Image_Attributes</a> in <span class="register">HL</span>.</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_Attributes_Loop</td>
<td class="address-2"><span id="dec9"></span>DEC9</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="2">Stash the attribute row counter and the image attributes buffer pointer on the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deca"></span>DECA</td>
<td class="instruction">PUSH HL</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="decb"></span>DECB</td>
<td class="instruction">LD A,$00</td>
<td class="comment-1" rowspan="1">Initialise the column counter in <span class="register">A</span>.</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_Attribute_Row</td>
<td class="address-2"><span id="decd"></span>DECD</td>
<td class="instruction">LD C,(IX+$00)</td>
<td class="comment-1" rowspan="1">Load the attribute value into <span class="register">C</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ded0"></span>DED0</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="2">Load the repeat length into <span class="register">B</span>.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ded2"></span>DED2</td>
<td class="instruction">LD B,(IX+$00)</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ded5"></span>DED5</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1">Move <span class="register">IX</span> to the next attribute/ repeat length pair.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ded7"></span>DED7</td>
<td class="instruction">ADD A,B</td>
<td class="comment-1" rowspan="1">Add the repeat length to the column counter.</td>
</tr>
<tr>
<td class="asm-label">GeneratePicture_Attribute_Run</td>
<td class="address-2"><span id="ded8"></span>DED8</td>
<td class="instruction">LD (HL),C</td>
<td class="comment-1" rowspan="1">Write the attribute to the image attributes buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="ded9"></span>DED9</td>
<td class="instruction">INC HL</td>
<td class="comment-1" rowspan="1">Increment the image attributes buffer pointer by one.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="deda"></span>DEDA</td>
<td class="instruction">DJNZ <a href="DE0F.html#ded8">GeneratePicture_Attribute_Run</a></td>
<td class="comment-1" rowspan="1">Decrease the repeat counter by one and loop back to <a href="DE0F.html#ded8">GeneratePicture_Attribute_Run</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dedc"></span>DEDC</td>
<td class="instruction">CP $14</td>
<td class="comment-1" rowspan="2">Jump to <a href="DE0F.html#decd">GeneratePicture_Attribute_Row</a> if 14 columns have been processed.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dede"></span>DEDE</td>
<td class="instruction">JR NZ,<a href="DE0F.html#decd">GeneratePicture_Attribute_Row</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee0"></span>DEE0</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">Restore the start of the current attribute row from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee1"></span>DEE1</td>
<td class="instruction">LD BC,$0014</td>
<td class="comment-1" rowspan="2">Move <span class="register">HL</span> to the next row in the attribute buffer.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee4"></span>DEE4</td>
<td class="instruction">ADD HL,BC</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee5"></span>DEE5</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">Restore the attribute row counter from the stack.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee6"></span>DEE6</td>
<td class="instruction">DJNZ <a href="DE0F.html#dec9">GeneratePicture_Attributes_Loop</a></td>
<td class="comment-1" rowspan="1">Decrease the attribute row counter by one and loop back to <a href="DEED.html#e0be">E0BE</a> until counter is zero.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="dee8"></span>DEE8</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="dee9"></span>
<div class="comments">
<div class="paragraph">
Variables specifically for this routine.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label">Line_Counter</td>
<td class="address-1"><span id="dee9"></span>DEE9</td>
<td class="instruction">DEFB $00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Operation_Code</td>
<td class="address-1"><span id="deea"></span>DEEA</td>
<td class="instruction">DEFB $C9</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label">Buffer_Position</td>
<td class="address-1"><span id="deeb"></span>DEEB</td>
<td class="instruction">DEFW <a href="A0E3.html#aacf">$AACF</a></td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="DDFA.html">DDFA</a>
</td>
<td class="up">Up: <a href="../demo.html#de0f">Map</a></td>
<td class="next">
Next: <a href="DEED.html">DEED</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">&copy; 1986 Domark Ltd &copy; 2024 ArcadeGeek LTD.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 9.4.</div>
<div class="repository">Link to <a rel="noopener nofollow" href="https://github.com/pobtastic/splittingimages/">Source code</a>.</div>
<div><a href="../dec/demo/DE0F.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>